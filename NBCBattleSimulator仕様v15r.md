# NBCBattleSimulator仕様v15r

## 概要

このソフトウェアはWebアプリとして動作する。
このソフトウェアはMORK BORGというTRPGシステムの派生である『信長の黒い城』TRPGの戦闘の勝率を算出するツールである。
このソフトウェアのタイトルは"信長の黒い城戦闘シミュレータ"です。

## 機能

『信長の黒い城』TRPG(以降NKと呼称)のルールに従い、複数のチームに分かれてそれぞれが敵対チームの殲滅もしくは敗走を目指す。
チーム設定を完了したのち、何回戦闘を行うかを入力する。
入力した回数の戦闘を行い、結果の集計を表示する。

## チーム

チームは最大4チーム参加可能とする。
チームはそれぞれ"A","B","C","D"とする。
チームはプレイヤーチームとNPCチームの二種類の性格がある。
"A"は常にプレイヤーチームとする。
"B","C","D"はNPCチームとする。
プレイヤーチームとNPCチームは攻撃判定方法が異なる。
チーム毎にどのチームと敵対関係か設定できる。
チームは自分の手番に自分の攻撃回数同じ回数攻撃を行う。

## ダイスロール

以下はダイスロールの表記である。

フォーマット
[ダイス数]D[ダイス面数]

例
3D6は3回1-6の範囲のランダムな数を生成して、それぞれの結果を合計する。

## 判定ロール

フォーマット
[能力値]DR[必要ダイスロール][ダイスロール補正]

例

心DR12-3はD20をロールし[心]の能力値を加算し-3を引く。結果が12以上なら成功。

### 戦闘状況設定

このアプリの使用者（以降ユーザーと呼称する）は戦闘状況として以下を入力する。

チーム数：最低2から最大4

チームAの敵対チーム
チームBの敵対チーム
チームCの敵対チーム
チームDの敵対チーム
チームAの内訳
チームBの内訳
チームCの内訳
チームDの内訳

チームメンバーをリストから削除できること。

### チームの内訳

それぞれのチームの内訳をリストから選んで追加する。
内訳の最初のメンバーはリーダーとみなす。
リーダーは士気判定の際の条件になる。

#### メンバーリスト

| メンバー名称 | 説明               |
| ------------ | ------------------ |
| PCランダム   | 能力と武装をランダムに決定 |
| NPCランダム  | 能力と武装をランダムに決定、PCと同様の人間を敵対する場合のメンバーで能力値や武装をPCと同様にランダムで決定する |
| PC指定       | メンバーエディタで作成したメンバーを追加 |
| NPC指定      | メンバーエディタで作成したメンバーを追加 |
| 足軽ファランクス | 敵対チームのメンバー |
| 百足衆 | 敵対チームのメンバー |
| ろくろ首 | 敵対チームのメンバー |
| 河童水軍 | 敵対チームのメンバー |
| 鬼 | 敵対チームのメンバー |
| 黒母衣戦象 | 敵対チームのメンバー |
| 黒茶頭 | 敵対チームのメンバー |
| 赤母衣髑髏 | 敵対チームのメンバー |
| 亡霊武者 | 敵対チームのメンバー |
| 禿ネズミ武将 | 敵対チームのメンバー |
| 第六点魔王信長 | 敵対チームのメンバー |
| 山犬雑兵 | 敵対チームのメンバー |
| 鎌鼬 | 敵対チームのメンバー |
| 生臭坊主 | 敵対チームのメンバー |
| 槍かつぎのやせがえる | 敵対チームのメンバー |
| 足軽兎 | 敵対チームのメンバー |
| のっぺら荒武者 | 敵対チームのメンバー |
| 鉄砲猩々 | 敵対チームのメンバー |
| 鉄騎猪 | 敵対チームのメンバー |
| くのいち狐 | 敵対チームのメンバー |
| 弾正狸 | 敵対チームのメンバー |
| からくり巴 | 敵対チームのメンバー |
| 烏天狗 | 敵対チームのメンバー |

##### チーム"A"の攻撃方法について

チーム"A"のメンバーは自分の手番に、所持している武器からランダムに１つを選びその武器で敵対チームのランダムなメンバーを1回攻撃します。

##### 敵対チームのメンバーの攻撃方法

[攻撃0] 初回のターンの攻撃方法
[攻撃1] 初回以外での最初のターンでの攻撃
[攻撃2] 初回以外での次のターンの攻撃
[攻撃3] 初回以外での３番目のターンの攻撃
[攻撃4] 初回以外での４番目のターンの攻撃
攻撃1,攻撃2,攻撃3,攻撃4のように0以外の数字がある場合最後の番号の攻撃の後は1に戻って繰り返す。これらはターン経過ごとに切り替わるサイクル（1ターン目：攻撃1、2ターン目：攻撃2…）です。
[攻撃E] そのメンバーが死亡した場合にターン終了時に攻撃する。
[攻撃R] 弾薬が尽きた場合や、武器が壊れた場合の攻撃手段。他に攻撃手段がなくなったときの予備攻撃手段。
攻撃の後にn回と書かれている場合、同じターンに連続してn回攻撃をすることを示しています。


##### 敵対チームのメンバーの詳細

[名称]:"足軽ファランクス"
[HP]:2D6+8
[士気]:開始時のHP
[防具]:LV2
[特殊防具]: -D2 (クリティカルで破壊)
[攻撃1]:2回 "足軽ファランクスの乱撃"
[攻撃2]:1回 "足軽ファランクスの乱撃と回復"
[攻撃時の特別ルール]:なし
[攻撃対象選定方法]:"ランダムに選定"

----
[名称]:"百足衆"
[HP]:12
[士気]:8
[防具]:LV2
[攻撃0]:2回"百足衆の奇襲"
[攻撃1]:2回"百姓から奪った鍬"
[攻撃2]:2回"百足衆の乱射"
[攻撃時の特別ルール]:なし
[攻撃対象選定方法]:"ランダムに選定"


----
[名称]:"ろくろ首"
[HP]:8
[士気]:4
[防具]:LV1
[攻撃1]:1回 "妖艶"
[攻撃2]:1回 "飛頭変"
[攻撃時の特別ルール]:なし
[攻撃対象選定方法]:"ランダムに選定"

----
[名称]:"河童水軍"
[HP]:10
[士気]:9
[防具]:LV4
[攻撃1]:1回 "相撲"
[攻撃時の特別ルール]:なし
[攻撃対象選定方法]:"ランダムに選定"

----
[名称]:"鬼"
[HP]:30
[士気]:1回のダメージが10以上で敗走
[防具]:-1D6
[攻撃1]:1回 "金棒"
[攻撃時の特別ルール]:なし
[攻撃対象選定方法]:"ランダムに選定"

----
[名称]:"黒母衣戦象"
[HP]:50
[士気]:10
[防具]:LV4
[攻撃1]:1回 "戦象の鼻"
[攻撃2]:1回 "戦象の足"
[攻撃3]:1回 "戦象の呪い"
[攻撃4]:1回 "戦象の死人踊り"
[攻撃時の特別ルール]:なし
[攻撃対象選定方法]:"ランダムに選定"

----
[名称]:"黒茶頭"
[HP]:18
[士気]:10
[防具]:LV4
[攻撃1]:1回 "黒茶頭の茶"
[攻撃時の特別ルール]:なし
[攻撃対象選定方法]:"ランダムに選定"

----
[名称]:"赤母衣髑髏"
[HP]:12
[士気]:10
[防具]:LV4
[攻撃0]:1回 "突撃"
[攻撃1]:1回 "大槍"
[攻撃時の特別ルール]:なし
[攻撃対象選定方法]:"ランダムに選定"

----
[名称]:"亡霊武者"
[HP]:5
[士気]:特殊:お経を聞くと撤退
[防具]:なし
[攻撃1]:1回 "亡霊武者の攻撃"
[攻撃時の特別ルール]:"亡霊への攻撃"
[攻撃対象選定方法]:"ランダムに選定"

----
[名称]:"禿ネズミ武将"
[HP]:25
[士気]:10
[防具]:LV4
[攻撃1]:1回 "姑息な奇襲"
[攻撃時の特別ルール]:なし
[攻撃対象選定方法]:"ランダムに選定"

----
[名称]:"第六点魔王信長"
[HP]:108
[士気]:なし
[防具]:-1D10
[攻撃1]:1回 "へし切り長谷部"
[攻撃時の特別ルール]:なし
[攻撃対象選定方法]:"ランダムに選定"

----
[名称]:"山犬雑兵"
[HP]:4
[士気]:7
[防具]:LV2
[攻撃1]:1回 "山犬雑兵の攻撃"
[攻撃時の特別ルール]:なし
[攻撃対象選定方法]:"ランダムに選定"

----
[名称]:"鎌鼬"
[HP]:4
[士気]:8
[防具]:-D3
[攻撃1]:2回 "鎌鼬の鎌"
[攻撃時の特別ルール]:なし
[攻撃対象選定方法]:"ランダムに選定"

----
[名称]:"生臭坊主"
[HP]:3
[士気]:なし
[防具]:なし
[攻撃1]:1回 "暗黒呪い"
[攻撃2]:2回 "鉤爪"
[攻撃時の特別ルール]:なし
[攻撃対象選定方法]:"ランダムに選定"

----
[名称]:"槍かつぎのやせがえる"
[HP]:7
[士気]:7
[防具]:LV2
[攻撃1]:1回 "槍"
[攻撃2]:2回 "蛙の蹴り"
[攻撃時の特別ルール]:なし
[攻撃対象選定方法]:"ランダムに選定"

----
[名称]:"足軽兎"
[HP]:3
[士気]:チーム内の足軽兎が1体でもダメージを受けたら、そのチームの全ての足軽兎が逃げ出す
[防具]:LV2
[攻撃1]:1回 "刀"
[攻撃時の特別ルール]:なし
[攻撃対象選定方法]:"ランダムに選定"

----
[名称]:"のっぺら荒武者"
[HP]:12
[士気]:11
[防具]:LV3
[攻撃1]:1回 "大槍"
[攻撃2]:1回 "赤い舌"
[攻撃時の特別ルール]:なし
[攻撃対象選定方法]:"ランダムに選定"

----
[名称]:"鉄砲猩々"
[HP]:10
[士気]:9
[防具]:LV2
[攻撃1]:1回 "大ざるの種子島銃"
[攻撃R]:1回 "馬の大腿骨"
[攻撃時の特別ルール]:なし
[攻撃対象選定方法]:"高HP"

----
[名称]:"鉄騎猪"
[HP]:10
[士気]:7
[防具]:LV4
[攻撃1]:1回 "猪の突進"
[攻撃時の特別ルール]:なし
[攻撃対象選定方法]:"ランダムに選定"

----
[名称]:"くのいち狐"
[HP]:10
[士気]:7
[防具]:-1D3
[攻撃1]:1回 "狐の誘惑"
[攻撃2]:1回 "狐の牙"
[攻撃時の特別ルール]:"狐の躱し"
[攻撃対象選定方法]:"ランダムに選定"

----
[名称]:"弾正狸"
[HP]:12
[士気]:10
[防具]:LV3
[攻撃1]:1D4回 "茶釜爆弾"
[攻撃2]:1回 "表裏の舞"
[攻撃3]:1D6回 "平蜘蛛"
[攻撃E]:1回 "狸の自爆"
[攻撃時の特別ルール]:なし
[攻撃対象選定方法]:"ランダムに選定"

----
[名称]:"からくり巴"
[HP]:15
[士気]:12
[防具]:LV3
[攻撃1]:1回 "斬馬刀"
[攻撃2]:1回 "刀"
[攻撃3]:2回 "からくり巴の手裏剣"
[攻撃時の特別ルール]:"木製"
[攻撃対象選定方法]:"ランダムに選定"

----
[名称]:"烏天狗"
[HP]:8
[士気]:9
[防具]:-1D3
[攻撃1]:1回 "弓矢"
[攻撃2]:1回 "義経流霞の太刀"
[攻撃時の特別ルール]:"飛翔体"
[攻撃対象選定方法]:"ランダムに選定"

#### メンバーエディタ

追加するメンバーを予め登録する機能。
メンバー内訳設定時に登録したメンバーを呼び出せる。
メンバーエディタではPCの能力値と装備を設定できる。
装備は装備一覧から登録する。


### プレイヤーチームのメンバー

プレイヤーチームのメンバーは以下の能力を持つ

#### 能力値

[心]
[技]
[体]
[耐久]
[HP]

#### 能力値決定方法

[心],[技],[体]は以下の方法で能力を決定する。
3D6をロールし
| 3D6 | 能力値 |
| 1-4 | -3     |
| 5-6 | -2     |
| 7-8 | -1     |
| 9-12 | 0     |
| 13-14 | +1   |
| 15-16 | +2   |
| 17-18 | +3   |

[HP]は1D8+耐久(最低1)で決定する。

#### プレイヤーチームの所持品決定

プレイヤーチームのそれぞれのメンバーは所持品を以下の表を１回使用して決定する。
全ての武器が破損した場合、"素手"による攻撃を行う。"素手"は破損しない。

| 1D12 | 所持品名称 |
| --- | --- |
| 1 | "尖らせた骨の杭" |
| 2 | "竹槍" |
| 3 | "百姓から奪った鍬" |
| 4 | "脇差し" |
| 5 | "手裏剣" |
| 6 | "刀" |
| 7 | "鎖鎌" |
| 8 | "太刀" |
| 9 | "種子島銃" |
| 10 | "大槍" |
| 11 | "爆裂弾" |
| 12 | "斬馬刀" |

#### プレイヤーチームの鎧決定

プレイヤーチームのそれぞれのメンバーは鎧レベルを以下の表を1回使用して決定する。

| 1D6 | 鎧レベル |
| --- | --- |
| 1 | 0 |
| 2 | 0 |
| 3 | 1 |
| 4 | 2 |
| 5 | 3 |
| 6 | 4 |

#### 鎧と鎧レベル

鎧は敵の攻撃が命中した際に、ダメージを軽減する。

| 鎧レベル | ダメージ軽減 |
| --- | --- |
| 0 | 0 |
| 1 | -1D2 |
| 2 | -1D3 |
| 3 | -1D4 |
| 4 | -1D6 |

攻撃がクリティカルヒットであった場合、攻撃を受けた相手の鎧レベルが1レベル下がる。
プレイヤーチームのメンバーで防御判定がファンブルだった場合鎧レベルが1レベル下がる。

敵チームメンバーには鎧レベルではなくダイスロールが設定されているものがある。
その場合、常にそのダイスロールをダメージ補正として用い、クリティカルやファンブルのレベル減少を起こさない。


#### チームメンバーの武装

チームメンバーは最低１種類の武装を持つ。
一人のメンバーが複数の武装を持つ場合がある。
複数の武装を持つメンバーは攻撃順序が決められている場合がある。
武装名称の後に番号がある場合ターン毎に番号順に攻撃を繰り返す。
武装名の後に0とある場合は最初のターンのみ使用する。
武装名の後にEとある場合はターン終了時に特別行動として使用する。
武装名の後になにも書かれていない場合はターン毎にランダムに使用する。

##### 武装のパラメータ

武装には以下のパラメータがある。

[名称]:その武装の名称
[種類]:近接武器もしくは射撃武器
[命中判定]:プレイヤーが命中させる際に補正に使う能力
[被命中判定]:プレイヤーが敵に攻撃された際に補正に使う能力
[ダメージ]:命中した場合に相手に与えるダメージ
[弾数]:使用できる回数、-1の場合は無限に使用可能

##### 武器の種類

近接武器:近距離から敵へ攻撃する
射撃武器:遠距離から敵へ攻撃する
範囲武器:範囲内にいる敵を攻撃する
敗走判定強制:使用したチームのターン終了時に相手チームの敗走判定を行う。

##### 武装の種類

[名称]:"素手"
[種類]:近接武器
[命中判定]:体DR12
[被命中判定]:技DR12
[ダメージ]:1D2
[弾数]:-1
[状態異常]:なし

----
[名称]:"尖らせた骨の杭"
[種類]:近接武器
[命中判定]:体DR12
[被命中判定]:技DR12
[ダメージ]:1D3
[弾数]:-1
[状態異常]:なし

----
[名称]:"竹槍"
[種類]:近接武器
[命中判定]:体DR12
[被命中判定]:技DR12
[ダメージ]:1D4
[弾数]:-1
[状態異常]:なし

----
[名称]:"百姓から奪った鍬"
[種類]:近接武器
[命中判定]:体DR12
[被命中判定]:技DR12
[ダメージ]:1D4
[弾数]:-1
[状態異常]:なし

----
[名称]:"脇差し"
[種類]:近接武器
[命中判定]:体DR12
[被命中判定]:技DR12
[ダメージ]:1D4
[弾数]:-1
[状態異常]:なし

----
[名称]:"脇差"
[種類]:近接武器
[命中判定]:体DR12
[被命中判定]:技DR12
[ダメージ]:1D4
[弾数]:-1
[状態異常]:なし

----
[名称]:"手裏剣"
[種類]:射撃武器
[命中判定]:心DR12
[被命中判定]:技DR12
[ダメージ]:1D4
[弾数]:1D6
[状態異常]:なし

----
[名称]:"刀"
[種類]:近接武器
[命中判定]:体DR12
[被命中判定]:技DR12
[ダメージ]:1D6
[弾数]:-1
[状態異常]:なし

----
[名称]:"鎖鎌"
[種類]:近接武器
[命中判定]:体DR12
[被命中判定]:技DR12
[ダメージ]:1D6
[弾数]:-1
[状態異常]:なし

----
[名称]:"太刀"
[種類]:近接武器
[命中判定]:体DR12
[被命中判定]:技DR12
[ダメージ]:1D8
[弾数]:-1
[状態異常]:なし

----
[名称]:"爆裂弾"
[種類]:射撃武器
[命中判定]:心DR12
[被命中判定]:技DR12
[ダメージ]:1D4
[弾数]:[心]+3
[状態異常]:なし

----
[名称]:"斬馬刀"
[種類]:近接武器
[命中判定]:体DR12
[被命中判定]:技DR12
[ダメージ]:1D10
[弾数]:-1
[状態異常]:なし

----
[名称]:"種子島銃"
[種類]:射撃武器
[命中判定]:心DR12
[被命中判定]:技DR12
[ダメージ]:2D6
[弾数]:[心]+5
[状態異常]:なし

----
[名称]:"大槍"
[種類]:近接武器
[命中判定]:体DR12
[被命中判定]:技DR12
[ダメージ]:1D8
[弾数]:-1
[状態異常]:なし

----
[名称]:"包丁"
[種類]:近接武器
[命中判定]:体DR12
[被命中判定]:技DR12
[ダメージ]:1D3
[弾数]:-1
[状態異常]:なし

----
[名称]:"般若心経の経文":E
[種類]:敗走判定強制
[命中判定]:なし
[被命中判定]:なし
[ダメージ]:なし
[弾数]:-1
[状態異常]:"敗走判定強制"

----
[名称]:"鎖20尺"
[種類]:近接武器
[命中判定]:体DR14
[被命中判定]:技DR14
[ダメージ]:1D6
[弾数]:-1
[状態異常]:なし

----
[名称]:"弓矢"
[種類]:射撃武器
[命中判定]:心DR12
[被命中判定]:技DR12
[ダメージ]:1D6
[弾数]:[心]+4
[状態異常]:なし

----
[名称]:"足軽ファランクスの乱撃"
[種類]:近接武器
[命中判定]:なし
[被命中判定]:技DR12
[ダメージ]:1D8
[弾数]:なし
[状態異常]:なし

----
[名称]:"足軽ファランクスの乱撃と回復"
[種類]:近接武器
[命中判定]:なし
[被命中判定]:技DR12
[ダメージ]:1D8
[弾数]:なし
[状態異常]:"回復"


----
[名称]:"妖艶"
[種類]:射撃武器
[命中判定]:なし
[被命中判定]:技DR12
[ダメージ]:1
[弾数]:なし
[状態異常]:"妖艶状態"
"妖艶状態":付与者の手番終了時に付与者がHP1回復、被付与者はHP1ダメージを受ける。被付与者は付与者を攻撃できない。被付与者の手番開始時に[心]DR12で回復判定を行う。

----
[名称]:"飛頭変"
[種類]:射撃武器
[命中判定]:なし
[被命中判定]:技DR16
[ダメージ]:1D6
[弾数]:なし
[状態異常]:なし

----
[名称]:"飛頭変"
[種類]:射撃武器
[命中判定]:なし
[被命中判定]:技DR16
[ダメージ]:1D6
[弾数]:なし
[状態異常]:なし


----
[名称]:"相撲"
[種類]:近接武器
[命中判定]:なし
[被命中判定]:体DR15
[ダメージ]:1D6
[弾数]:なし
[状態異常]:"尻子玉"

----
[名称]:"金棒"
[種類]:近接武器
[命中判定]:なし
[被命中判定]:技DR12
[ダメージ]:1D10
[弾数]:なし
[状態異常]:"吠える声"

----
[名称]:"戦象の鼻"
[種類]:近接武器
[命中判定]:なし
[被命中判定]:技DR12
[ダメージ]:1D8
[弾数]:なし
[状態異常]:なし

----
[名称]:"戦象の鼻"
[種類]:近接武器
[命中判定]:なし
[被命中判定]:技DR12
[ダメージ]:1D8
[弾数]:なし
[状態異常]:なし

----
[名称]:"戦象の足"
[種類]:近接武器
[命中判定]:なし
[被命中判定]:技DR10
[ダメージ]:1D12
[弾数]:なし
[状態異常]:なし

----
[名称]:"戦象の呪い"
[種類]:近接武器
[命中判定]:なし
[被命中判定]:耐久DR12
[ダメージ]:1D3
[弾数]:なし
[状態異常]:"麻痺１ターン"

----
[名称]:"戦象の死人踊り"
[種類]:近接武器
[命中判定]:なし
[被命中判定]:常に
[ダメージ]:足軽ファランクス１体がメンバーに追加
[弾数]:なし
[状態異常]:なし

----
[名称]:"黒茶頭の茶"
[種類]:近接武器
[命中判定]:なし
[被命中判定]:心DR15
[ダメージ]:なし
[弾数]:なし
[状態異常]:"宇宙の深淵"

----
[名称]:"百足衆の奇襲"
[種類]:射撃武器
[命中判定]:心DR12
[被命中判定]:技DR15
[ダメージ]:2D6
[弾数]:無限
[状態異常]:なし

----
[名称]:"百足衆の乱射"
[種類]:射撃武器
[命中判定]:心DR12
[被命中判定]:技DR12
[ダメージ]:2D6
[弾数]:無限
[状態異常]:なし

----
[名称]:"亡霊武者の攻撃"
[種類]:近接武器
[命中判定]:なし
[被命中判定]:技DR12
[ダメージ]:1D6
[弾数]:無限
[状態異常]:"麻痺の吐息"

----
[名称]:"姑息な奇襲"
[種類]:近接武器
[命中判定]:なし
[被命中判定]:心DR15
[ダメージ]:1D8
[弾数]:無限
[状態異常]:"禿ネズミの感染"

----
[名称]:"へし切長谷部"
[種類]:近接武器
[命中判定]:なし
[被命中判定]:技DR15
[ダメージ]:1D12+1
[弾数]:無限
[状態異常]:"信長の攻撃"

----
[名称]:"山犬雑兵の攻撃"
[種類]:近接武器
[命中判定]:なし
[被命中判定]:技DR12
[ダメージ]:1D4
[弾数]:なし
[状態異常]:"槍からの感染"

----
[名称]:"鎌鼬の鎌"
[種類]:近接武器
[命中判定]:なし
[被命中判定]:技DR12
[ダメージ]:1D4
[弾数]:なし
[状態異常]:なし

----
[名称]:"暗黒呪い"
[種類]:近接武器
[命中判定]:なし
[被命中判定]:心DR16
[ダメージ]:被命中判定の不足分をダメージとする
[弾数]:なし
[状態異常]:なし

----
[名称]:"鉤爪"
[種類]:近接武器
[命中判定]:なし
[被命中判定]:技DR12
[ダメージ]:1D3
[弾数]:なし
[状態異常]:なし

----
[名称]:"蛙の蹴り"
[種類]:近接武器
[命中判定]:なし
[被命中判定]:技DR12
[ダメージ]:1D3
[弾数]:なし
[状態異常]:"蹴りによる効果"

----
[名称]:"赤い舌"
[種類]:近接武器
[命中判定]:なし
[被命中判定]:技DR12
[ダメージ]:1D4
[弾数]:なし
[状態異常]:"舐めて回復"

----
[名称]:"猪の突進"
[種類]:近接武器
[命中判定]:なし
[被命中判定]:技DR12
[ダメージ]:1D8
[弾数]:なし
[状態異常]:なし

----
[名称]:"狐の誘惑"
[種類]:近接武器
[命中判定]:なし
[被命中判定]:心DR14
[ダメージ]:1D8
[弾数]:なし
[状態異常]:"装備外し"

----
[名称]:"狐の牙"
[種類]:近接武器
[命中判定]:なし
[被命中判定]:技DR12
[ダメージ]:1D4
[弾数]:なし
[状態異常]:なし

----
[名称]:"茶釜爆弾"
[種類]:範囲武器
[命中判定]:なし
[被命中判定]:技DR12
[ダメージ]:1D4
[弾数]:なし
[状態異常]:なし

----
[名称]:"表裏の舞"
[種類]:近接武器
[命中判定]:なし
[被命中判定]:心DR14
[ダメージ]:なし
[弾数]:なし
[状態異常]:"舞につられる"

----
[名称]:"平蜘蛛"
[種類]:近接武器
[命中判定]:なし
[被命中判定]:技DR12
[ダメージ]:1D6
[弾数]:なし
[状態異常]:なし

----
[名称]:"狸の自爆"
[種類]:範囲攻撃
[命中判定]:なし
[被命中判定]:技DR12
[ダメージ]:1D10
[弾数]:なし
[状態異常]:なし

----
[名称]:"からくり巴の手裏剣"
[種類]:射撃武器
[命中判定]:心DR12
[被命中判定]:技DR12
[ダメージ]:1D4
[弾数]:無限
[状態異常]:なし

----
[名称]:"義経流霞の太刀"
[種類]:近接武器
[命中判定]:心DR14
[被命中判定]:技DR14
[ダメージ]:1D6
[弾数]:なし
[状態異常]:なし

----
[名称]:"突撃"
[種類]:近接武器
[命中判定]:心DR14
[被命中判定]:技DR14
[ダメージ]:1D10
[弾数]:なし
[状態異常]:なし

----
[名称]:"大ざるの種子島銃"
[種類]:射撃武器
[命中判定]:心DR12
[被命中判定]:技DR12
[ダメージ]:2D6
[弾数]:5
[状態異常]:なし



###### 状態異常

[名称]:"妖艶状態"
[発動条件]:心DR12
[解除方法]:心DR12
[効果]:付与者の手番終了時に付与者のHP+1,被付与者のHP-1。付与者へ攻撃できない。

----
[名称]:"尻子玉"
[発動条件]:相撲攻撃で対象者のHPが減少した場合に耐久DR15
[解除方法]:即解除
[効果]:対象者の耐久-1,対象者の耐久が-4になると対象者は死亡。

----
[名称]:"吠える声"
[発動条件]:攻撃時に相手チーム全員が心DR10で発動
[解除方法]:この状態異常を持つ者の手番開始時に心DR10で解除、以降この状態異常にはかからない
[効果]:行動不能

----
[名称]:"麻痺１ターン"
[発動条件]:常に
[解除方法]:この状態異常を持つ者の手番終了時に解除
[効果]:行動不能

----
[名称]:"宇宙の深淵"
[発動条件]:心DR15
[解除方法]:効果的用語に解除
[効果]:HPが2回復,再度心DR15を行い失敗したら1D6ダメージ

----
[名称]:"麻痺の吐息"
[発動条件]:耐久DR8
[解除方法]:耐久DR8
[効果]:行動不能,HP-1

----
[名称]:"禿ネズミの感染"
[発動条件]:ダメージを1点以上受けた,耐久DR15に失敗
[解除方法]:常に解除
[効果]:以下の状態異常を判定せずに付与 "感染","敗走"

----
[名称]:"信長の攻撃"
[発動条件]:ダメージを1点以上受けた,心DR15に失敗
[解除方法]:常に解除
[効果]:以下の状態異常を判定せずに付与 "敗走"

----
[名称]:"感染"
[発動条件]:常に
[解除方法]:なし
[効果]:とくになし

----
[名称]:"敗走"
[発動条件]:心DR15
[解除方法]:なし
[効果]:メンバーは敗走したとみなす

----
[名称]:"槍からの感染"
[発動条件]:防御DRでファンブル
[解除方法]:なし
[効果]:以下の状態異常を判定せずに付与 "感染"

----
[名称]:"蹴りによる効果"
[発動条件]:体DR8
[解除方法]:次の手番後に自動解除
[効果]:すべての行動に-2のダイスロール補正

----
[名称]:"舐めて回復"
[発動条件]:命中したら
[解除方法]:効果発動後に自動解除
[効果]:効果付与者のHPが1点回復する

----
[名称]:"装備外し"
[発動条件]:命中したら
[解除方法]:効果発動後に自動解除
[効果]:武器を一つ捨てる、武器がなければ防具を捨てる

----
[名称]:"舞につられる"
[発動条件]:命中したら
[解除方法]:なし
[効果]:以降すべての判定ロール-3の補正

----
[名称]:"回復"
[発動条件]:つねに
[解除方法]:即解除
[効果]:付与者が直ちにHPを1D6回復する

##### 対象攻撃時の特別ルール

----
[名称]:"亡霊への攻撃"
[効果]:対象者へのダメージは常に1となる

----
[名称]:"狐の躱し"
[効果]:命中判定補正-2,攻撃がファンブルならランダムに選んだ同じチームの活動中の仲間一人に1D4ダメージを与える

----
[名称]:"木製"
[効果]:"爆裂弾"が命中した場合ダメージが2倍になる

----
[名称]:"飛翔体"
[効果]:射撃武器以外で攻撃する場合、対象の直前の攻撃が[攻撃2]である必要がある。

##### 攻撃対象選定方法

[名称]:"ランダムに選定"
[選定方法]:敵対グループの活動中全メンバーからランダムに選定する

[名称]:"高HP"
[選定方法]:敵対グループの活動中全メンバーから攻撃の時点で最もHPの大きいメンバーを狙う。複数いる場合はそのなかからランダムに選ぶ。

[名称]:"低HP"
[選定方法]:敵対グループの活動中全メンバーから攻撃の時点で最もHPの小さいメンバーを狙う。複数いる場合はそのなかからランダムに選ぶ。


## 戦闘

それぞれのチームは１ターンにイニシアチブが高いものから順番に攻撃を行う。
ターンの最後に１チームだけが存在する状態になったら１回の戦闘は終了したものとみなすし結果を保存する。
ターン数が100に達した場合、戦闘は終了する（引き分け/時間切れ）。

### 戦闘手順

1. イニシアチブ決定
2. チーム毎手番処理
3. 敵対チームの殲滅または敗走チェック
4. ターン終了

#### イニシアチブ決定

チーム毎に1D6を振り、その値をイニシアチブとする。
チームにイニシアチブ補正があるならその値を加える。
同じ値のチームがある場合、その順序は不定（実装依存）とする。
最もイニシアチブが高いチームの手番から順番にチーム毎手番処理を行う。

#### チーム毎手番処理

チームの各メンバーは以下の手順で攻撃を行う。
1. 攻撃対象選定
2. 攻撃

特殊攻撃がある場合、その特殊攻撃を実行する。

#### 攻撃対象選定

攻撃対象選定種別にしたがって攻撃対象を決定する。


### 敵対チームの殲滅または敗走チェック

同じチームのメンバーのうち、全員死亡または敗走した場合。そのチームは以降戦闘に参加しない。

#### 敗走判定の条件

チーム"A"以外のチームは以下の条件のどれかを満たすとき敗走チェックを行う
チームのリーダーが死亡した。
チームの半数が死亡した。
一人だけのチームの場合HPが３割以下になった。

#### 敗走判定と結果

2D6をロールし、生き残っているチームメンバーのうち最も高い士気のメンバーの値を超えた場合。そのチーム全体に以下の結果を適用する。
1D6し1-3:敗走,4-6:降伏

#### 攻撃

人間型メンバーの場合、所持している武器の中からランダムに1つ選んで攻撃する。
人間型メンバーは１回の手番で１回だけ攻撃する。
攻撃判定は武器の[命中判定]の内容を利用する。
人間型メンバーは[命中判定]がなしの武器を利用できない。
もし人間型のメンバーが[命中判定]がなしの武器を所持している場合、エラーを出す。
人間型以外のメンバーは、敵対チームのメンバーの攻撃方法 に記載した内容で攻撃を行う。
人間型メンバーが非人間型メンバーへ攻撃した場合、人間型メンバーの[命中判定]として命中を判定する。
被人間型メンバーが人間型メンバーへ攻撃した場合。非人間型メンバーの[非命中判定]として命中を判定する。

攻撃判定は1D20で判定する。
判定の詳細は、各武器の[命中判定]もしくは[非命中判定]の内容にしたがう。

人間型メンバーが攻撃判定する際に修正前のダイスロールが20の場合クリティカルとみなす。
人間型メンバーが攻撃判定する際に修正前のダイスロールが1の場合ファンブルとみなす。
攻撃がクリティカルの場合、ダメージが２倍になり、相手の鎧レベルを1レベル低下させる。
攻撃がファンブルの場合、攻撃したメンバーの武器を使用不能にする。

人間型メンバーが防御判定する際に修正前のダイスロールが20の場合クリティカルとみなす。
人間型メンバーが攻撃判定する際に修正前のダイスロールが1の場合ファンブルとみなす。
防御がクリティカルの場合、相手に対して１回攻撃できる。
防御がファンブルの場合、ダメージが２倍になり、鎧が１レベル低下する。


##### HPが0以下になった場合

人間型メンバーのHPが0になった場合、そのメンバーは重症状態となる。
直ちに1D4をロールして以下の結果に従う

| 1D4 | 結果 |
| --- | --- |
| 1 | 1D4ラウンド意識不明、そのごHPに1D4をプラスする |
| 2 | 1D4ラウンド意識不明、そのごHPに1D4をプラスする |
| 3 | 出血状態、ただし戦闘には影響なし |
| 4 | 死亡 |

HPが-1以下になった場合は死亡する。

人間型以外のメンバーはHP0で死亡する。

### 戦闘結果

以下を記録する。
チーム"A"の開始時生存者数
チーム"A"の終了時生存者数
チーム"A"以外の開始時生存者数
チーム"A"以外の終了時生存者数
チーム"A"以外の逃走者数

### 最終戦闘結果

#### 中間データ

最終戦闘結果計算用の中間データ。

チーム"A"の開始時生存者数の合計
チーム"A"の終了時生存者数の合計
チーム"A"以外の開始時生存者数の合計
チーム"A"以外の終了時生存者数の合計
チーム"A"以外の逃走者数の合計

#### 結果

各チームは以下の値を計算する。
チームの生存率 = チームの終了時生存者数の合計 / チームの開始時生存者数の合計
チームの逃走率 = チームの逃走者数の合計 / チーム開始時生存者数の合計
各チームの勝率 = 各チームが時間切れ以外で最後まで残った回数 / 各チームの戦闘参加回数

この結果を表示する。

## 攻撃対象選定種別

## 業(gou)について

業は人間型メンバーが持つ、サポートポイントである。
作成したキャラクターは業2ポイントで開始します。

業1ポイントでできることは以下の通り

* 使用したメンバーの1回の攻撃で最大のダメージを与える（実装では固定の大きな値（10等）をダメージとする）
* 他の敵チームを含む他のメンバーのロールをやり直す
* 仕様したメンバーのダメージを1D6下げる
* 他の敵チームを含む他のメンバーのクリティカルまたはファンブルを打ち消す（防具破損、武器の損壊、カウンター攻撃、ダメージ２倍をなくす）
* 使用者の判定ダイスロールの結果を+4する。重複しても良い

## チームAの人数指定オプション

この機能は、チームAについて、人数だけを指定して毎回メンバーをクリアして、人数分をランダムに選んでメンバーを追加する機能です。
このオプションにより、様々な構成メンバーで敵と対峙した際の勝率を確認することができます。

## バージョン表示機能

画面タイトルの下に、現在のバージョンを表示する。

現在のバージョンは,1.2.1とする。

## 戦闘条件ファイルの読み込みと戦闘結果のファイル出力

この機能は、戦闘条件を記したcsv形式のファイルを読み込み、戦闘を実行した後、戦闘結果を記したcsv形式のファイルに出力する機能です。

* 戦闘条件ファイルはユーザーが指定できる。
* 戦闘結果はユーザーがダウンロードする形で出力する。
* チームAの敵対チームは常にチームBとする。
* チームBの敵対チームは常にチームAとする。
* **この機能はPC版（画面幅が一定以上の環境）でのみ提供し、スマートフォン版では非表示または使用不可とする。**

### 戦闘条件ファイルのフォーマット

デリミターはカンマとする。

\# で始まる行はコメント行とみなす。

試行回数,チームAの人数,チームBのモンスター名,チームBのモンスター数

### 戦闘結果ファイルのフォーマット

デリミターはカンマとする。

\# で始まる行はコメント行とみなす

試行回数,チームAの人数,チームBのモンスター名,チームBのモンスター数,チームAの勝率,チームAの生存率,チームBの勝率,チームBの敗走/逃走率

## スマートフォン対応（レスポンシブWebアプリ化）

この機能は、Webアプリをスマートフォン（iPhone/Android）の画面サイズに対応させるものである。
単一のコード（リポジトリ）でPC版とスマートフォン版の両方に対応する。

### 実装要件

*   **レスポンシブレイアウト**: 画面幅に応じてレイアウトを調整する。
    *   PC版で2列表示などのレイアウトを、スマートフォン版では1列表示に切り替えるなど、画面幅に最適化する。
    *   CSSメディアクエリを使用して実装する。
*   **タッチ操作対応**: スマートフォンでの操作性を考慮する。
    *   ボタンや入力フォームなどのタップ領域を、指で操作しやすいサイズ（44px以上推奨）に拡大・調整する。
*   **フォントサイズ調整**: スマートフォンの画面サイズに合わせて文字サイズを適切に調整する。
    *   PC向けの大きな見出しなどは、スマートフォンでは適切なサイズに縮小する。
